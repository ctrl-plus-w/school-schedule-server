{"version":3,"sources":["../../src/utils/authorization.js"],"names":["role","user","role_name","isProfessor","config","ROLES","PROFESSOR","ADMIN","isAdmin","checkIsProfessor","Promise","resolve","reject","errors","DEFAULT","NOT_ALLOWED","checkIsAdmin"],"mappings":";;;;;;;;;AAAA;;AACA;;;;AAEO,MAAMA,IAAI,GAAIC,IAAD,IAAUA,IAAI,CAACD,IAAL,CAAUE,SAAjC;;;;AAEA,MAAMC,WAAW,GAAIH,IAAD,IAAUA,IAAI,KAAKI,gBAAOC,KAAP,CAAaC,SAAtB,IAAmCN,IAAI,KAAKI,gBAAOC,KAAP,CAAaE,KAAvF;;;;AACA,MAAMC,OAAO,GAAIR,IAAD,IAAUA,IAAI,KAAKI,gBAAOC,KAAP,CAAaE,KAAhD;;;;AAEA,MAAME,gBAAgB,GAAIR,IAAD,IAAU;AACxC,SAAO,IAAIS,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,QAAI,CAACX,IAAL,EAAWW,MAAM,CAACC,gBAAOC,OAAR,CAAN;AACX,QAAI,CAACX,WAAW,CAACH,IAAI,CAACC,IAAD,CAAL,CAAhB,EAA8BW,MAAM,CAACC,gBAAOE,WAAR,CAAN;AAC9BJ,IAAAA,OAAO;AACR,GAJM,CAAP;AAKD,CANM;;;;AAQA,MAAMK,YAAY,GAAIf,IAAD,IAAU;AACpC,SAAO,IAAIS,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,QAAI,CAACX,IAAL,EAAWW,MAAM,CAACC,gBAAOC,OAAR,CAAN;AACX,QAAI,CAACN,OAAO,CAACR,IAAI,CAACC,IAAD,CAAL,CAAZ,EAA0BW,MAAM,CAACC,gBAAOE,WAAR,CAAN;AAC1BJ,IAAAA,OAAO;AACR,GAJM,CAAP;AAKD,CANM","sourcesContent":["import errors from '../config/errors';\nimport config from '../config';\n\nexport const role = (user) => user.role.role_name;\n\nexport const isProfessor = (role) => role === config.ROLES.PROFESSOR || role === config.ROLES.ADMIN;\nexport const isAdmin = (role) => role === config.ROLES.ADMIN;\n\nexport const checkIsProfessor = (user) => {\n  return new Promise((resolve, reject) => {\n    if (!user) reject(errors.DEFAULT);\n    if (!isProfessor(role(user))) reject(errors.NOT_ALLOWED);\n    resolve();\n  });\n};\n\nexport const checkIsAdmin = (user) => {\n  return new Promise((resolve, reject) => {\n    if (!user) reject(errors.DEFAULT);\n    if (!isAdmin(role(user))) reject(errors.NOT_ALLOWED);\n    resolve();\n  });\n};\n"],"file":"authorization.js"}