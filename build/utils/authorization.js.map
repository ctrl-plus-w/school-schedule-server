{"version":3,"sources":["../../src/utils/authorization.js"],"names":["role","user","role_name","isProfessor","config","ROLES","PROFESSOR","ADMIN","isAdmin","checkIsProfessor","Promise","resolve","reject","errors","DEFAULT","NOT_ALLOWED","checkIsAdmin"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEO,IAAMA,IAAI,GAAG,SAAPA,IAAO,CAACC,IAAD;AAAA,SAAUA,IAAI,CAACD,IAAL,CAAUE,SAApB;AAAA,CAAb;;;;AAEA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACH,IAAD;AAAA,SAAUA,IAAI,KAAKI,mBAAOC,KAAP,CAAaC,SAAtB,IAAmCN,IAAI,KAAKI,mBAAOC,KAAP,CAAaE,KAAnE;AAAA,CAApB;;;;AACA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACR,IAAD;AAAA,SAAUA,IAAI,KAAKI,mBAAOC,KAAP,CAAaE,KAAhC;AAAA,CAAhB;;;;AAEA,IAAME,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACR,IAAD,EAAU;AACxC,SAAO,IAAIS,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAI,CAACX,IAAL,EAAWW,MAAM,CAACC,mBAAOC,OAAR,CAAN;AACX,QAAI,CAACX,WAAW,CAACH,IAAI,CAACC,IAAD,CAAL,CAAhB,EAA8BW,MAAM,CAACC,mBAAOE,WAAR,CAAN;AAC9BJ,IAAAA,OAAO;AACR,GAJM,CAAP;AAKD,CANM;;;;AAQA,IAAMK,YAAY,GAAG,SAAfA,YAAe,CAACf,IAAD,EAAU;AACpC,SAAO,IAAIS,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAI,CAACX,IAAL,EAAWW,MAAM,CAACC,mBAAOC,OAAR,CAAN;AACX,QAAI,CAACN,OAAO,CAACR,IAAI,CAACC,IAAD,CAAL,CAAZ,EAA0BW,MAAM,CAACC,mBAAOE,WAAR,CAAN;AAC1BJ,IAAAA,OAAO;AACR,GAJM,CAAP;AAKD,CANM","sourcesContent":["import errors from '../config/errors';\nimport config from '../config';\n\nexport const role = (user) => user.role.role_name;\n\nexport const isProfessor = (role) => role === config.ROLES.PROFESSOR || role === config.ROLES.ADMIN;\nexport const isAdmin = (role) => role === config.ROLES.ADMIN;\n\nexport const checkIsProfessor = (user) => {\n  return new Promise((resolve, reject) => {\n    if (!user) reject(errors.DEFAULT);\n    if (!isProfessor(role(user))) reject(errors.NOT_ALLOWED);\n    resolve();\n  });\n};\n\nexport const checkIsAdmin = (user) => {\n  return new Promise((resolve, reject) => {\n    if (!user) reject(errors.DEFAULT);\n    if (!isAdmin(role(user))) reject(errors.NOT_ALLOWED);\n    resolve();\n  });\n};\n"],"file":"authorization.js"}