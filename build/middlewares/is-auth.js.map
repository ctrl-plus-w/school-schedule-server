{"version":3,"sources":["../../src/middlewares/is-auth.js"],"names":["req","get","authHeader","auth","split","token","decodedToken","jwt","verify","config","JWT_KEY","id","role","full_name"],"mappings":";;;;;;;AAAA;;AAEA;;;;;;;;;sEAEe;AAAA;AAAA;AAAA;AAAA;AAAA;AAASA,YAAAA,GAAT,QAASA,GAAT;AAAA;AAAA,mBACYA,GAAG,CAACC,GAAJ,CAAQ,eAAR,CADZ;;AAAA;AACPC,YAAAA,UADO;;AAAA,gBAGRA,UAHQ;AAAA;AAAA;AAAA;;AAAA,6CAGW;AAAEC,cAAAA,IAAI,EAAE;AAAR,aAHX;;AAAA;AAAA;AAAA,mBAKOD,UAAU,CAACE,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CALP;;AAAA;AAKPC,YAAAA,KALO;;AAAA,kBAMT,CAACA,KAAD,IAAUA,KAAK,KAAK,EANX;AAAA;AAAA;AAAA;;AAAA,6CAMsB;AAAEF,cAAAA,IAAI,EAAE;AAAR,aANtB;;AAAA;AAAA;AASLG,YAAAA,YATK,GASUC,yBAAIC,MAAJ,CAAWH,KAAX,EAAkBI,mBAAOC,OAAzB,CATV;;AAAA,gBAUNJ,YAVM;AAAA;AAAA;AAAA;;AAAA,6CAUe;AAAEH,cAAAA,IAAI,EAAE;AAAR,aAVf;;AAAA;AAAA,6CAYJ;AACLA,cAAAA,IAAI,EAAE,IADD;AAELQ,cAAAA,EAAE,EAAEL,YAAY,CAACK,EAFZ;AAGLC,cAAAA,IAAI,EAAEN,YAAY,CAACM,IAHd;AAILC,cAAAA,SAAS,EAAEP,YAAY,CAACO,SAJnB;AAKLR,cAAAA,KAAK,EAAEA;AALF,aAZI;;AAAA;AAAA;AAAA;AAAA,6CAoBJ;AAAEF,cAAAA,IAAI,EAAE;AAAR,aApBI;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import jwt from 'jsonwebtoken';\n\nimport config from '../config';\n\nexport default async ({ req }) => {\n  const authHeader = await req.get('Authorization');\n\n  if (!authHeader) return { auth: false };\n\n  const token = await authHeader.split(' ')[1];\n  if (!token || token === '') return { auth: false };\n\n  try {\n    const decodedToken = jwt.verify(token, config.JWT_KEY);\n    if (!decodedToken) return { auth: false };\n\n    return {\n      auth: true,\n      id: decodedToken.id,\n      role: decodedToken.role,\n      full_name: decodedToken.full_name,\n      token: token,\n    };\n  } catch (err) {\n    return { auth: false };\n  }\n};\n"],"file":"is-auth.js"}