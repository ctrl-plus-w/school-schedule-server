{"version":3,"sources":["../../src/middlewares/is-auth.js"],"names":["req","authHeader","get","auth","token","split","decodedToken","jwt","verify","config","JWT_KEY","id","role","full_name","err"],"mappings":";;;;;;;;;;;AAAA;;AAEA;;;;eAEe,gBAAmB;AAAA,MAAZ;AAAEA,IAAAA;AAAF,GAAY;AAChC,QAAMC,UAAU,GAAG,MAAMD,GAAG,CAACE,GAAJ,CAAQ,eAAR,CAAzB;AAEA,MAAI,CAACD,UAAL,EAAiB,OAAO;AAAEE,IAAAA,IAAI,EAAE;AAAR,GAAP;AAEjB,QAAMC,KAAK,GAAG,MAAMH,UAAU,CAACI,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAApB;AACA,MAAI,CAACD,KAAD,IAAUA,KAAK,KAAK,EAAxB,EAA4B,OAAO;AAAED,IAAAA,IAAI,EAAE;AAAR,GAAP;;AAE5B,MAAI;AACF,UAAMG,YAAY,GAAGC,sBAAIC,MAAJ,CAAWJ,KAAX,EAAkBK,gBAAOC,OAAzB,CAArB;;AACA,QAAI,CAACJ,YAAL,EAAmB,OAAO;AAAEH,MAAAA,IAAI,EAAE;AAAR,KAAP;AAEnB,WAAO;AACLA,MAAAA,IAAI,EAAE,IADD;AAELQ,MAAAA,EAAE,EAAEL,YAAY,CAACK,EAFZ;AAGLC,MAAAA,IAAI,EAAEN,YAAY,CAACM,IAHd;AAILC,MAAAA,SAAS,EAAEP,YAAY,CAACO,SAJnB;AAKLT,MAAAA,KAAK,EAAEA;AALF,KAAP;AAOD,GAXD,CAWE,OAAOU,GAAP,EAAY;AACZ,WAAO;AAAEX,MAAAA,IAAI,EAAE;AAAR,KAAP;AACD;AACF,C","sourcesContent":["import jwt from 'jsonwebtoken';\n\nimport config from '../config';\n\nexport default async ({ req }) => {\n  const authHeader = await req.get('Authorization');\n\n  if (!authHeader) return { auth: false };\n\n  const token = await authHeader.split(' ')[1];\n  if (!token || token === '') return { auth: false };\n\n  try {\n    const decodedToken = jwt.verify(token, config.JWT_KEY);\n    if (!decodedToken) return { auth: false };\n\n    return {\n      auth: true,\n      id: decodedToken.id,\n      role: decodedToken.role,\n      full_name: decodedToken.full_name,\n      token: token,\n    };\n  } catch (err) {\n    return { auth: false };\n  }\n};\n"],"file":"is-auth.js"}